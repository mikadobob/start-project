{"version":3,"sources":["assets\\scripts\\Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport { Player } from \"./Player\";\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class Game extends cc.Component {\r\n\r\n    @property(cc.Prefab)\r\n    private starPrefab: cc.Prefab = null;\r\n\r\n    @property\r\n    private maxStarDuration = 0;\r\n\r\n    @property\r\n    private minStarDuration = 0;\r\n\r\n    @property(cc.Node)\r\n    private ground: cc.Node = null;\r\n\r\n    @property(Player)\r\n    public player: Player = null;\r\n\r\n    @property(cc.Label)\r\n    private scoreDisplay: cc.Label = null;\r\n\r\n    @property(cc.AudioClip)\r\n    private scoreAudio: cc.AudioClip = null;\r\n\r\n    private groundY: number = 0;\r\n    private score: number;\r\n    public timer: number;\r\n    public starDuration: number;\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        // Obtain the anchor point of ground level on the y axis\r\n        this.groundY = this.ground.y + this.ground.height / 2; // \"this.ground.top\" may also work\r\n\r\n        this.timer = 0;\r\n        this.starDuration = 0;\r\n\r\n        // Generate a new star\r\n        this.spawnNewStar();\r\n\r\n        this.score = 0;\r\n    }\r\n\r\n    spawnNewStar() {\r\n        // Generate a new node in the scene with a preset template\r\n        var newStar = cc.instantiate(this.starPrefab);\r\n        // Put the newly added node under the Canvas node\r\n        this.node.addChild(newStar);\r\n        // Set up a random position for the star\r\n        newStar.setPosition(this.getNewStarPosition());\r\n\r\n        newStar.getComponent('Star').game = this;\r\n\r\n        this.starDuration = this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);\r\n        this.timer = 0;\r\n    }\r\n\r\n    getNewStarPosition() {\r\n        var randX = 0;\r\n        // According to the position of the ground level and the main character's jump height, randomly obtain an anchor point of the star on the y axis\r\n        var randY = this.groundY + Math.random() * this.player.jumpHeight + 50;\r\n        // According to the width of the screen, randomly obtain an anchor point of star on the x axis\r\n        var maxX = this.node.width / 2;\r\n        randX = (Math.random() - 0.5) * 2 * maxX;\r\n        // Return to the anchor point of the star\r\n        return cc.v2(randX, randY);\r\n    }\r\n\r\n    gainScore() {\r\n        this.score += 1;\r\n        this.scoreDisplay.string = \"Score: \" + this.score.toString();\r\n\r\n        cc.audioEngine.playEffect(this.scoreAudio, false);\r\n    }\r\n\r\n    gameOver() {\r\n        this.player.stopAllActions();\r\n\r\n        cc.director.loadScene('game');\r\n    }\r\n\r\n\r\n    update(dt) {\r\n        if (this.timer > this.starDuration) {\r\n            this.gameOver();\r\n            return;\r\n        }\r\n        this.timer += dt;\r\n    }\r\n}\r\n"]}